<?xml version="1.0" encoding="GBK"?>

<!-- Log4j 2.x config -->
<Configuration status="OFF">
  <Appenders>
    <Console name="Console" target="SYSTEM_OUT">
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
    </Console>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/connection-event.log"
      filePattern="${LOG_HOME}/connection-event.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="ConnectionEventAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/remoting-rpc.log"
      filePattern="${LOG_HOME}/remoting-rpc.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="RpcRemotingAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/remoting-tr-adapter.log"
      filePattern="${LOG_HOME}/remoting-tr-adapter.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="TrAdapterRemotingAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/remoting-msg.log"
      filePattern="${LOG_HOME}/remoting-msg.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="MsgRemotingAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/remoting-http.log"
      filePattern="${LOG_HOME}/remoting-http.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="HttpRemotingAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/common-error.log"
      filePattern="${LOG_HOME}/common-error.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="ERROR-APPENDER">
      <!-- only print error log -->
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
      <ThresholdFilter level="error" onMatch="ACCEPT" onMismatch="DENY"/>
    </RollingRandomAccessFile>

    <RollingRandomAccessFile append="true"
      fileName="${LOG_HOME}/common-default.log"
      filePattern="${LOG_HOME}/common-default.log.%d{yyyy-MM-dd}"
      immediateFlush="false"
      name="CommonDefaultAppender">
      <Filters>
        <ThresholdFilter level="ERROR" onMatch="DENY" onMismatch="NEUTRAL"/>
        <ThresholdFilter level="${LOG_LEVEL}" onMatch="ACCEPT" onMismatch="DENY"/>
      </Filters>
      <PatternLayout charset="${LOG_ENCODE}">
        <pattern>%d %-5p [%C{1}#%L] [%t] %m%n</pattern>
      </PatternLayout>
      <Policies>
        <TimeBasedTriggeringPolicy interval="1" modulate="true"/>
      </Policies>
    </RollingRandomAccessFile>

  </Appenders>

  <!-- appenders -->
  <Loggers>
    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="CommonDefault">
      <appender-ref ref="CommonDefaultAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="ConnectionEvent">
      <appender-ref ref="ConnectionEventAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="RpcRemoting">
      <appender-ref ref="RpcRemotingAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="TrAdapterRemoting">
      <appender-ref ref="TrAdapterRemotingAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="MsgRemoting">
      <appender-ref ref="MsgRemotingAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <AsyncLogger additivity="false" level="${LOG_LEVEL}" name="HttpRemoting">
      <appender-ref ref="HttpRemotingAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </AsyncLogger>

    <root level="${LOG_LEVEL}">
      <appender-ref ref="CommonDefaultAppender"/>
      <appender-ref ref="ERROR-APPENDER"/>
    </root>
  </Loggers>

  <!-- loggers -->
  <properties>
    <Property name="LOG_LEVEL">${sys:com.alipay.remoting.client.log.level}</Property>
    <Property name="LOG_ENCODE">${sys:com.alipay.remoting.client.log.encode}</Property>
    <property name="LOG_HOME">${sys:logging.path}/bolt</property>
  </properties>
</Configuration>